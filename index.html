<!DOCTYPE HTML>
<html lang="en">
<head>
	<title>Project - starfox | home page</title>

	<meta charset="UTF-8">
  	<meta name="author" content="Michal Pruszkowski">
  	<meta name="description" content="">
 	<meta name="keywords" content="">
 	<meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no">

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">

    <link rel="stylesheet" href="css/style.css">
</head>

<body id="index_master_container">
    <!--Change html tags to be js based only, i.e, generated by js script-->
    <div id="loading_screen">
        <button type="button" id="start_btn" class="option_btn" data-sfxhover="version1" data-sfxclick="version1">Start</button>
        <div id="loadnig_bar">
            <span id="loading_progress">0%</span>
        </div>
    </div>

    <header id="index_header">
        <div class="position-absolute top-0 start-0">
            <!--
            <button type="button" onclick="muteBackgroundMusic()">Mute</button>
            -->

        </div>
        <!--Title-->
        <h1 class="text-center">Project Starfox</h1>
        <hr>
        <!--Subtitle-->
        <p class="text-center">Honours Project Web Browser Game </p>
    </header>

    <div id="menu_window">
        <nav id="menu_content" class="list-group text-center mt-5">
            <!--
                Change text inside buttons to svg so they can scale better
                <svg viewBox="0 0 56 18">
                    <text x="0" y="15">Fit Me</text>
                </svg>
            -->
            
            <a class="option_btn" href="hangar.html" data-sfxhover="version1" data-sfxclick="version1">Start</a>
            <!--
                <a class="option_btn" href="gameScreen.html" data-sfxhover="version1" data-sfxclick="version1">Play</a>
                 <a class="option_btn" href="#" data-sfxhover="version1" data-sfxclick="version1">About</a>
            -->
        
            <button class="option_btn" type="button" onclick="showOptionsMenu()" data-sfxhover="version1" data-sfxclick="version1">Options</button>
        </nav>
    </div>

    <div id="options_window">
        <nav id="options_content" class="mt-5">
            <!--Options section is populated by JavaScript-->
            <section id="options_section"></section>

            <section id="options_buttons">
                <button class="option_btn" type="button" data-sfxhover="version1" data-sfxclick="version1">Reset</button>
                <button class="option_btn" type="button" onclick="saveOptions()" data-sfxhover="version1" data-sfxclick="version1">Save</button>

                <button class="option_btn" type="button" onclick="showMainMenu()" data-sfxhover="version1" data-sfxclick="version1">Back</button>
            </section>
        </nav>
    </div>

    <footer id="index_footer">
        <p>Napier University</p>
        <p>Michal Pruszkowski</p>
    </footer>
</body>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>

<script type="module" src="./optionsHandler.js"></script>

<script type="module">
import {createAudioElementBck, assignSFXevents, setAudioUI} from './utilities/audioHandler.js';
import user_data from "./user/user_data.json" assert { type: "json" }; 

//debug
//localStorage.removeItem('user_data');
//////////////////

const local_user_data = localStorage.getItem('user_data') 
    ? JSON.parse(localStorage.getItem('user_data')) 
    : (localStorage.setItem('user_data', JSON.stringify(user_data)), JSON.parse(localStorage.getItem('user_data')));


let url = new URL(window.location.href);
let params = new URLSearchParams(url.search);

var bckMusicSrc = "./Data/Audio/Music/bck_main_menu.mp3";
var bckMusicTrackName = "bck_menu_music";

if(params.has("visited") === true){
    let urlState = params.get("visited");

    createAudioElementBck(bckMusicSrc, bckMusicTrackName, true);
    const UI_SFX = setAudioUI();
    assignSFXevents(UI_SFX);

    document.getElementById("start_btn").style.display = "none";
    document.getElementById("loading_screen").style.display = "none";

    document.getElementById("index_header").style.display = "initial"; 
    document.getElementById("menu_window").style.display = "initial";
    document.getElementById("index_footer").style.display = "initial"; 
} else {
    window.onload = function(){
        const UI_SFX = setAudioUI();
        assignSFXevents(UI_SFX);

        createAudioElementBck(bckMusicSrc, bckMusicTrackName, true);

        var loadingProgress = document.getElementById("loading_progress");

        loadingProgress.style.width = "50vw";
        loadingProgress.innerHTML = "100%";

        document.getElementById("start_btn").style.display = "initial"; 

        document.getElementById("start_btn").addEventListener("click", function(){
            document.getElementById("start_btn").style.display = "none";
            document.getElementById("loading_screen").style.display = "none";

            document.getElementById("index_header").style.display = "initial"; 
            document.getElementById("menu_window").style.display = "initial";
            document.getElementById("index_footer").style.display = "initial";  
        });
    }
}


/*
window.muteBackgroundMusic = function(bckMusicID){
    var bckMenuMusic = document.getElementById(bckMusicID);

    if(bckMenuMusic && bckMenuMusic.muted != true){
    bckMenuMusic.muted = true;

    } else if(bckMenuMusic && bckMenuMusic.muted == true){
        bckMenuMusic.muted = false;
    }
}
*/
</script>
</html>